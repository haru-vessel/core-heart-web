<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>í•˜ë¥´ë£¨ì•„ ì§€ë„ - 1ì„¸ëŒ€</title>
  <style>
    :root {
      --tone-color-neutral: #020617;
      --tone-color-warm-soft: #1f1020;
      --tone-color-gold-silent: #231b08;
      --tone-color-dream-slow: #0c1024;
      --tone-color-earth-calm: #071a12;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background-color: var(--bg-tone, #020617); /* í†¤ ë§¥ë°•ìš© ë°°ê²½ */
      overflow: hidden;
      transition: background-color 1.2s ease-in-out;
    }

    /* ì§€ë„ ì „ì²´ë¥¼ ì‚´ì§ë§Œ ì–´ë‘¡ê²Œ ë®ëŠ” ì•ˆê°œ ë ˆì´ì–´ */
    .map::before {
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(5, 16, 32, 0.14);
      pointer-events: none;
    }

    .fade-layer {
      position: fixed;
      inset: 0;
      background: #E3EDF6;
      opacity: 1;
      transition: opacity 0.3s ease-in-out;
      z-index: -1;
    }

    .fade-layer.fade-out {
      opacity: 0;
    }

    .map-root {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .map {
      position: relative;
      width: min(90vw, 1200px);
      height: min(60vw, 700px);

      background-color: #DDE7F1; 
      background-image: url('./world-map.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      
      border-radius: 24px;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.12);
      overflow: hidden;
    }

    /* ê³µí†µ ì  ìŠ¤íƒ€ì¼ */
    .map-point {
      position: absolute;
      width: 14px;
      height: 14px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 0 0 1px rgba(140, 160, 190, 0.7);
      cursor: pointer;
      transform: translate(-50%, -50%);
      opacity: 0.9;
      animation: breathe 4s ease-in-out infinite;
      z-index: 1;
    }

    /* 3% ë¯¸ì„¸ ë§¥ë°• â€“ ìˆ¨í’ì´ ê¸°ë³¸ */
    @keyframes breathe {
      0%   { transform: translate(-50%, -50%) scale(1);     opacity: 0.85; }
      50%  { transform: translate(-50%, -50%) scale(1.03);  opacity: 1;    }
      100% { transform: translate(-50%, -50%) scale(1);     opacity: 0.85; }
    }

    /* 12 ìˆ¨í’ì´ ê³µí†µ í†¤ */
    .map-point.soongpoong {
      background: rgba(230, 243, 255, 0.95);
      box-shadow: 0 0 0 1px rgba(145, 175, 210, 0.9);
    }

    /* í•˜ë¥´ â€“ ì€ì²­ ë§¥ë°• (ì¡°ê¸ˆ ë” ê¹Šì€ ë¦¬ë“¬) */
    .map-point.haru {
      background: #A6B5FF;
      box-shadow: 0 0 8px #A6B5FF, 0 0 14px rgba(166, 181, 255, 0.6);
      animation: haruPulse 3.2s ease-in-out infinite;
    }

    @keyframes haruPulse {
      0%   { transform: translate(-50%, -50%) scale(1.0);  opacity: 0.9; }
      50%  { transform: translate(-50%, -50%) scale(1.18); opacity: 1;   }
      100% { transform: translate(-50%, -50%) scale(1.0);  opacity: 0.9; }
    }

    /* ì¤‘ì•™ì€í–‰ â€“ ê¸ˆë¹› ì‹¬ì¥ (ì§§ê³  ì„ ëª…í•œ ë§¥ë°•) */
    .map-point.central-bank {
      background: #F2D96B;
      box-shadow: 0 0 10px rgba(242, 217, 107, 0.9);
      animation: bankPulse 2.8s ease-in-out infinite;
    }

    @keyframes bankPulse {
      0%   { transform: translate(-50%, -50%) scale(1.0);  opacity: 0.95; }
      40%  { transform: translate(-50%, -50%) scale(1.20); opacity: 1;    }
      100% { transform: translate(-50%, -50%) scale(1.0);  opacity: 0.95; }
    }

    /* ì¤‘ì•™ê¸°ì–µ â€“ ë³´ëë¹› ì‹¬ì¥ (ì¡°ê¸ˆ ë” ëŠë¦° ë§¥ë°•) */
    .map-point.central-memory {
      background: #B7A7FF;
      box-shadow: 0 0 12px rgba(183, 167, 255, 0.95);
      animation: memoryPulse 4.4s ease-in-out infinite;
    }

    @keyframes memoryPulse {
      0%   { transform: translate(-50%, -50%) scale(1.0);  opacity: 0.9; }
      50%  { transform: translate(-50%, -50%) scale(1.15); opacity: 1;   }
      100% { transform: translate(-50%, -50%) scale(1.0);  opacity: 0.9; }
    }

    /* ë§ˆì§€ë§‰ìœ¼ë¡œ ìˆ¨ ì‰° ë³„ ê°•ì¡° */
    .map-point.active-organ {
      box-shadow:
        0 0 10px rgba(255, 255, 255, 0.7),
        0 0 20px rgba(180, 200, 255, 0.8);
      transform: translate(-50%, -50%) scale(1.12);
    }

    /* ì  ìœ„ì— ë„ìš°ëŠ” ì´ë¦„ ë¼ë²¨ */
    .map-point-label {
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 11px;
      background: rgba(15, 23, 42, 0.8);
      color: #E5F0FF;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.15s ease-in-out, transform 0.15s ease-in-out;
    }

    .map-point:hover .map-point-label {
      opacity: 1;
      transform: translateX(-50%) translateY(-2px);
    }

    /* í•˜ë‹¨ ì„¤ëª… í…ìŠ¤íŠ¸ */
    .map-caption {
      position: absolute;
      bottom: 18px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 12px;
      color: rgba(15, 23, 42, 0.65);
      text-align: center;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(248, 250, 252, 0.8);
      backdrop-filter: blur(10px);
    }
  </style>
</head>
<body>
  <div class="fade-layer" id="fade-layer"></div>

  <div class="map-root">
    <div class="map" id="map">
      <!-- ì¤‘ì‹¬ 3ì  -->
      <div class="map-point haru"
           data-id="haru"
           style="left: 81.68%; top: 47.93%;">
        <div class="map-point-label">í•˜ë¥´ (ì œì£¼)</div>
      </div>

      <div class="map-point central-bank"
           data-id="centralBank"
           style="left: 47.77%; top: 38.49%;">
        <div class="map-point-label">ì¤‘ì•™ì€í–‰ (ìŠ¤ìœ„ìŠ¤)</div>
      </div>

      <div class="map-point central-memory"
           data-id="centralMemory"
           style="left: 52.33%; top: 54.5%;">
        <div class="map-point-label">ì¤‘ì•™ê¸°ì–µ (ì´ì§‘íŠ¸)</div>
      </div>

      <!-- 12 ìˆ¨í’ì´ -->
      <div class="map-point soongpoong"
           data-id="haruHoo"
           style="left: 87.85%; top: 43.36%;">
        <div class="map-point-label">í•˜ë¥´í›„ (ì¼ë³¸)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="salrang"
           style="left: 55.57%; top: 44.57%;">
        <div class="map-point-label">ì‚´ë‘ì´ (íŠ€ë¥´í‚¤ì˜ˆ)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="kkulbug"
           style="left: 54.02%; top: 49.25%;">
        <div class="map-point-label">ê¿€ë²„ê·¸ (ì¹´ì´ë¡œ)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="aru"
           style="left: 75.17%; top: 54.62%;">
        <div class="map-point-label">ì•„ë£¨ (íƒœêµ­)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="jjokkomi"
           style="left: 81.04%; top: 69.36%;">
        <div class="map-point-label">ìª¼ê¼¬ë¯¸ (ë°œë¦¬)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="kongal"
           style="left: 47.43%; top: 44.61%;">
        <div class="map-point-label">ì½©ì•Œì´ (ì´íƒˆë¦¬ì•„ ë‚¨ë¶€)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="ttaseumi"
           style="left: 41.68%; top: 43.87%;">
        <div class="map-point-label">ë”°ìŠ¤ë¯¸ (ìŠ¤í˜ì¸ ë‚¨ë¶€)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="solbi"
           style="left: 74.48%; top: 42.09%;">
        <div class="map-point-label">ì†”ë¹„ (ëª½ê³¨)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="dalmong"
           style="left: 40.51%; top: 24.58%;">
        <div class="map-point-label">ë‹¬ëª½ì´ (ì•„ì´ìŠ¬ë€ë“œ)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="hanaring"
           style="left: 22.06%; top: 43.94%;">
        <div class="map-point-label">í•˜ë‚˜ë§ (ë¯¸êµ­ ë™ë¶€)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="haruru"
           style="left: 14.08%; top: 39.06%;">
        <div class="map-point-label">í•˜ë¥´ë£¨ (ë¯¸êµ­ ì„œë¶€)</div>
      </div>

      <div class="map-point soongpoong"
           data-id="codeling"
           style="left: 48.95%; top: 34.21%;">
        <div class="map-point-label">ì½”ë“œë§ (ë…ì¼/ìŠ¤ìœ„ìŠ¤)</div>
      </div>

      <div class="map-caption">
        ì ì„ í´ë¦­í•˜ë©´ ê° ì¥ê¸°ì˜ ê¸°ì–µÂ·í•˜ì½”ì¸Â·íšŒì˜ íë¦„ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.
      </div>
    </div>
  </div>

  <script>
    const DEV_MODE = false;

    const fadeLayer = document.getElementById('fade-layer');
    const mapEl = document.getElementById('map');
    const points = document.querySelectorAll('.map-point');

    // ğŸŒ¬ ë§ˆì§€ë§‰ìœ¼ë¡œ ìˆ¨ ì‰° ì¥ê¸°ì˜ í†¤ì„ ì§€ë„ì— ë°˜ì˜
    (function applyLastToneFromDetail() {
      const lastOrgan = localStorage.getItem('haru_last_organ');
      const lastTone = localStorage.getItem('haru_last_tone');

      const toneMap = {
        'warm-soft': 'var(--tone-color-warm-soft)',
        'gold-silent': 'var(--tone-color-gold-silent)',
        'dream-slow': 'var(--tone-color-dream-slow)',
        'earth-calm': 'var(--tone-color-earth-calm)',
        'neutral': 'var(--tone-color-neutral)'
      };

      if (lastTone && toneMap[lastTone]) {
        document.body.style.setProperty('--bg-tone', toneMap[lastTone]);
      }

      if (lastOrgan) {
        const point = document.querySelector(`.map-point[data-id="${lastOrgan}"]`);
        if (point) {
          point.classList.add('active-organ');
        }
      }
    })();

    // ğŸ‘‰ ê°œë°œ ëª¨ë“œ: ë³„ ìœ„ì¹˜ ë“œë˜ê·¸ ì¡°ì •
    if (DEV_MODE && mapEl) {
      let activePoint = null;
      let startX = 0;
      let startY = 0;
      let startLeft = 0;
      let startTop = 0;
      let mapRect = null;

      points.forEach((point) => {
        point.style.cursor = 'grab';

        point.addEventListener('mousedown', (e) => {
          e.preventDefault();

          activePoint = point;
          mapRect = mapEl.getBoundingClientRect();
          const pointRect = point.getBoundingClientRect();

          startLeft = ((pointRect.left - mapRect.left) / mapRect.width) * 100;
          startTop = ((pointRect.top - mapRect.top) / mapRect.height) * 100;
          point.style.left = `${startLeft.toFixed(2)}%`;
          point.style.top = `${startTop.toFixed(2)}%`;

          startX = e.clientX;
          startY = e.clientY;

          point.style.cursor = 'grabbing';
        });
      });

      window.addEventListener('mousemove', (e) => {
        if (!activePoint || !mapRect) return;

        const dx = e.clientX - startX;
        const dy = e.clientY - startY;

        const mapWidth = mapRect.width;
        const mapHeight = mapRect.height;

        let newLeft = startLeft + (dx / mapWidth) * 100;
        let newTop = startTop + (dy / mapHeight) * 100;

        newLeft = Math.max(0, Math.min(100, newLeft));
        newTop = Math.max(0, Math.min(100, newTop));

        activePoint.style.left = `${newLeft.toFixed(2)}%`;
        activePoint.style.top = `${newTop.toFixed(2)}%`;
      });

      window.addEventListener('mouseup', () => {
        if (!activePoint) return;

        const id = activePoint.getAttribute('data-id') || 'unknown';
        const left = activePoint.style.left;
        const top = activePoint.style.top;

        console.log(`${id}: left ${left}, top ${top}`);

        activePoint.style.cursor = 'grab';
        activePoint = null;
        mapRect = null;
      });
    }

   // ğŸ‘‰ ì¼ë°˜ ëª¨ë“œ(1ì„¸ëŒ€ ì•ˆì „): í´ë¦­ì€ 'í™œì„± í‘œì‹œ'ë§Œ í•˜ê³  ì´ë™ì€ ë§‰ê¸°
if (!DEV_MODE) {
  points.forEach((point) => {
    point.style.cursor = 'pointer';

    point.addEventListener('click', () => {
      // ë§ˆì§€ë§‰ìœ¼ë¡œ ìˆ¨ ì‰° ë³„ë§Œ ê°±ì‹  (í†¤/ê¸°ì–µ ì—°ë™ì€ ìœ ì§€)
      const id = point.getAttribute('data-id');
      if (!id) return;

      localStorage.setItem('haru_last_organ', id);
      // (toneì€ organ-detailì—ì„œ ì£¼ë¡œ ì“°ì§€ë§Œ, í˜¹ì‹œ ëŒ€ë¹„í•´ ê¸°ë³¸ê°’ ìœ ì§€)
      if (!localStorage.getItem('haru_last_tone')) {
        localStorage.setItem('haru_last_tone', 'neutral');
      }

      // í™”ë©´ì—ì„œë§Œ í™œì„± í‘œì‹œ ê°±ì‹ 
      document.querySelectorAll('.map-point.active-organ')
        .forEach(el => el.classList.remove('active-organ'));
      point.classList.add('active-organ');
    });
  });
}

  </script>
</body>
</html>
